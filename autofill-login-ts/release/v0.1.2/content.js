(()=>{console.log("ðŸ” Password Autofill content script LOADED!");class e{constructor(){console.log("ðŸ” FormDetector initialized"),this.observeForms()}async getCredentials(){try{return(await chrome.runtime.sendMessage({action:"getCredentials"})).credentials||[]}catch(e){return console.error("Error loading credentials:",e),[]}}observeForms(){new MutationObserver(()=>{this.scanForForms()}).observe(document.body,{childList:!0,subtree:!0}),this.scanForForms()}scanForForms(){const e=document.querySelectorAll("form");Array.from(e).forEach((e,s)=>{e.hasAttribute("data-autofill-processed")||(e.setAttribute("data-autofill-processed","true"),this.processContainer(e,s))});const s=document.querySelectorAll("div#form");Array.from(s).forEach((e,s)=>{e.hasAttribute("data-autofill-processed")||(e.setAttribute("data-autofill-processed","true"),this.processContainer(e,s))})}processContainer(e,s){console.log(`ðŸ” Processing container ${s}:`,e);const t=Array.from(e.querySelectorAll("input")),o=this.findFieldsFromInputs(t);console.log("ðŸ” Found fields:",o),o.username&&o.password&&this.addAutofillButton(o,e,s)}findFieldsFromInputs(e){const s={};for(const t of e)if(this.isPasswordField(t)){s.password=t;break}for(const t of e)if(!s.username&&this.isUsernameField(t)){s.username=t;break}return s}isPasswordField(e){const s=(e.name||"").toLowerCase(),t=(e.id||"").toLowerCase(),o=(e.placeholder||"").toLowerCase(),n=(e.type||"").toLowerCase();return["pass","pwd","hasÅ‚o","password"].some(e=>s.includes(e)||t.includes(e)||o.includes(e)||"password"===n)}isUsernameField(e){const s=(e.name||"").toLowerCase(),t=(e.id||"").toLowerCase(),o=(e.placeholder||"").toLowerCase(),n=(e.type||"").toLowerCase();return["user","login","email","username","account","auth","name","id","identifier","uid","usr","mail"].some(e=>s.includes(e)||t.includes(e)||o.includes(e)||"email"===n||"text"===n&&(s.includes("user")||s.includes("login")))}addAutofillButton(e,s,t){var o;const n=s.previousElementSibling;if(n&&n.classList.contains("autofill-button"))return;const r=document.createElement("button");r.type="button",r.innerHTML="ðŸ” AutoFill",r.className="autofill-button",r.style.cssText="\n      background: #4285f4;\n      color: white;\n      border: none;\n      padding: 8px 12px;\n      border-radius: 4px;\n      cursor: pointer;\n      font-size: 12px;\n      margin: 10px 0;\n      font-family: inherit;\n      display: block;\n    ",r.addEventListener("click",()=>{this.fillCredentials(e)}),null===(o=s.parentNode)||void 0===o||o.insertBefore(r,s),console.log("ðŸ” AutoFill button added!")}async fillCredentials(e){const s=await this.getCredentials();if(0===s.length)return;const t=s[0];e.username&&(e.username.value=t.username,e.username.dispatchEvent(new Event("input",{bubbles:!0})),e.username.dispatchEvent(new Event("change",{bubbles:!0})),console.log("ðŸ” Filled username:",e.username)),e.password&&(e.password.value=t.password,e.password.dispatchEvent(new Event("input",{bubbles:!0})),e.password.dispatchEvent(new Event("change",{bubbles:!0})),console.log("ðŸ” Filled password:",e.password)),this.showSuccessMessage(e)}showSuccessMessage(e){const s=document.createElement("div");s.textContent="âœ“ Dane wypeÅ‚nione!",s.style.cssText="\n      position: fixed;\n      top: 20px;\n      right: 20px;\n      background: #4CAF50;\n      color: white;\n      padding: 10px 15px;\n      border-radius: 4px;\n      z-index: 10000;\n      font-size: 14px;\n      box-shadow: 0 2px 10px rgba(0,0,0,0.2);\n    ",document.body.appendChild(s),setTimeout(()=>{s.parentNode&&s.parentNode.removeChild(s)},2e3)}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{new e}):new e})();